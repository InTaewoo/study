## 3장에서 다루는 내용

- 파드의 생성, 실행, 정지
- 파드와 다른 리소스를 레이블로 조직화하기
- 특정 레이블을 가진 모든 파드에서 작업 수행
- 네임스페이스를 사용해 파드를 겹치지 않는 그룹으로 나누기
- 특정한 형식을 가진 워커 노드에 파드 배치

## 파드(Pod)소개
- 함께 배치된 컨테이너 그룹이며 쿠버네티스의 기본 빌딩 블록이다.
- 컨테이너를 개별적으로 배포하기보다는 컨테이너를 가진 파드를 배포하고 운영한다.
- 파드가 여러 컨테이너를 가지고 있을때, 모든 컨테이너는 항상 하나의 워커 노드에서 실행되며 여러 워커 노드에 걸쳐 실행되지 않는다.

![image](https://user-images.githubusercontent.com/81672260/147723747-e4e1a04d-7d55-48cf-864a-75d05fdf7ae0.png)

## 파드가 필요한 이유
### 여러 프로세스를 실행하는 단일 컨테이너보다 다중 컨테이너가 나은 이유

쿠버네티스는 항상 컨테이너에서 실행시키고, 이 각 컨테이너는 격리된 머신과 비슷하다. 모든 프로세스는 동일한 표준 출력으로 로그를 기록하기 때문에 어떤 프로세스가 남긴 로그인지 파악하는 것이 매우 어렵다. 따라서 각 프로세스를 자체의 개별 컨테이너로 실행해야 한다.

## 파드 이해하기
- 여러 프로세스를 단일 컨테이너로 묶지 않기 때문에, 컨테이너를 함께 묶고 하나의 단위로 관리할 수 있는 또 다른 상위 구조가 필요하다. 이것이 파드가 필요한 이유다.
- 파드의 모든 컨테이너는 동일한 네트워크 네임스페이스와 UTS 네임스페이스 안에서 실행되기 때문에, 모든 컨테이너는 같은 호스트 이름과 네트워크 인터페이스를 공유한다.

## 컨테이너가 동일한 IP와 포트 공간을 공유하는 방법
- 파드 안의 컨테이너가 동일한 네트워크 네임스페이스에서 실행되기 때문에, 동일한 IP주소와 포트 공간을 공유한다.
- 컨테이너에서 실행중인 프로세스가 같은 포트 번호를 사용하지 않도록 주의해야 한다.

## 파드에서 여러 컨테이너를 사용하는 경우
![image](https://user-images.githubusercontent.com/81672260/147728023-926f32fa-8162-4775-9fe5-68f8305588cc.png)

파드는 밀접하게 관련된 컨테이너로 구성된다. 일반적으로 주 컨테이너와 이를 보조하는 컨테이너로 이뤄진다.

![image](https://user-images.githubusercontent.com/81672260/147728877-b0002058-cc6c-4989-9be8-5b51907cf177.png)

- 컨테이너는 여러 프로세스를 실행하지 말아야 한다. 파드는 동일한 머신에서 실행할 필요가 없다면 여러 컨테이너를 포함하지 말아야 한다.

## 파드를 정의하는 주요 부분 소개
- Metadata : 이름, 네임스페이스, 레이블 및 파드에 관한 기타 정보를 포함한다.
- Spec : 파드 컨테이너, 볼륨, 기타 데이터 등 파드 자체에 관한 실제 명세를 가진다.
- Status : 파드 상태, 각 컨테이너 설명과 상태, 파드 내부 IP, 기타 기본 정보 등 현재 실행 중인 파드에 관한 현재 정보를 나타냄.
- 새 파드를 만들 때 status 부분은 작성할 필요가 없음

## 파드를 정의하는 간단한 YAML 정의 작성하기

![image](https://user-images.githubusercontent.com/81672260/147795965-6c944cf1-cb1a-430b-a2f2-eac9c56a4a97.png)


- API vi 버전을 준수한다.
- 정의하는 리소스 유형은 파드이며, 이름은 kubia-manual이다.
- 파드는 oilehot0910/kubia 이미지 기반 단일 컨테이너로 구성된다.
- 컨테이너에 이름을 지정하고 8080포트에서 연결을 기다리는 것을 표시했다.

## kubectl create 명령으로 파드 만들기
```
kubectl create -f kubia-manual.yaml
```

### 실행 중인 파드의 전체 정의 가져오기
- 파드를 만든 후에는 쿠버네티스에파드의 전체 YAML을 요청할 수 있다.

```
kubectl get po kubia-manual -o yaml
```

JSON으로 보기 원한다면 kubectl 명령으로 YAML 대신에 JSON을 반환하도록 할 수 있다.

```
kubectl get po kubia-manual -o json
```
![image](https://user-images.githubusercontent.com/81672260/147796362-40de3286-a73d-4279-9f2b-8cfc557a836d.png)


kubia-manual 파드가 실행 중이라는 것을 볼 수 있다.


## 애플리케이션 로그 보기
```
docker logs <container id>
```
 ### kubectl logs를 이용해 파드 로그 가져오기
 
 ```
 kubectl logs kubia-manual
 ```
 - 어떠한 웹 요청도 Node.js 애플리케이션으로 보내지 않았기 때문에, 서버가 시작할 때 남긴 로그 한 줄만 표시된다.


